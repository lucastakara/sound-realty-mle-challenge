worker_processes  auto;

events {
  worker_connections  1024;
}

http {
  include       /etc/nginx/mime.types;
  default_type  application/octet-stream;

  # Log format that prints which upstream served the request
  log_format upstreamlog '$remote_addr "$request" status=$status '
                         'upstream=$upstream_addr upstream_status=$upstream_status '
                         'req_time=$request_time upstream_time=$upstream_response_time';

  # Send logs to Docker logs (stdout/stderr)
  access_log /dev/stdout upstreamlog;
  error_log  /dev/stderr warn;

  sendfile        on;
  keepalive_timeout  65;

  # Load all conf.d files (this is where upstream + server live)
  include /etc/nginx/conf.d/*.conf;
}